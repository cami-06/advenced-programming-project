from crawler.crawler import Crawler
from scanners.auth.auth_scanner import AuthScanner
from scanners.sql.sql_scanner import SQLScanner
from reporter.reporter import Reporter
from core.http_client import HttpClient


start_url = "http://testphp.vulnweb.com/"


crawler = Crawler(start_url)
crawler.run()

http_client = HttpClient()
reporter = Reporter()

# ======================
# Auth scan
# ======================
auth_scanner = AuthScanner(crawler, http_client, reporter)
auth_scanner.scan()

# ======================
# SQL Injection scan
# ======================
sql_scanner = SQLScanner(crawler, http_client, reporter)
sql_scanner.scan()

reporter.generate()
